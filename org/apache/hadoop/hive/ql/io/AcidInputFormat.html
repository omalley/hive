<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_192-ea) on Mon Aug 26 13:32:59 PDT 2019 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AcidInputFormat (Hive 3.1.2 API)</title>
<meta name="date" content="2019-08-26">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="AcidInputFormat (Hive 3.1.2 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AcidInputFormat.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/hadoop/hive/ql/io/AbstractStorageFormatDescriptor.html" title="class in org.apache.hadoop.hive.ql.io"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.AcidRecordReader.html" title="interface in org.apache.hadoop.hive.ql.io"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hive/ql/io/AcidInputFormat.html" target="_top">Frames</a></li>
<li><a href="AcidInputFormat.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.hadoop.hive.ql.io</div>
<h2 title="Interface AcidInputFormat" class="title">Interface AcidInputFormat&lt;KEY extends org.apache.hadoop.io.WritableComparable,VALUE&gt;</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>VALUE</code> - The row type</dd>
</dl>
<dl>
<dt>All Superinterfaces:</dt>
<dd>org.apache.hadoop.mapred.InputFormat&lt;KEY,VALUE&gt;, <a href="../../../../../../org/apache/hadoop/hive/ql/io/InputFormatChecker.html" title="interface in org.apache.hadoop.hive.ql.io">InputFormatChecker</a></dd>
</dl>
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../../../org/apache/hadoop/hive/ql/io/orc/OrcInputFormat.html" title="class in org.apache.hadoop.hive.ql.io.orc">OrcInputFormat</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">AcidInputFormat&lt;KEY extends org.apache.hadoop.io.WritableComparable,VALUE&gt;</span>
extends org.apache.hadoop.mapred.InputFormat&lt;KEY,VALUE&gt;, <a href="../../../../../../org/apache/hadoop/hive/ql/io/InputFormatChecker.html" title="interface in org.apache.hadoop.hive.ql.io">InputFormatChecker</a></pre>
<div class="block">The interface required for input formats that what to support ACID
 transactions.
 <p>
 The goal is to provide ACID transactions to Hive. There are
 several primary use cases:
 <ul>
   <li>Streaming ingest- Allow Flume or Storm to stream data into Hive
   tables with relatively low latency (~30 seconds).</li>
   <li>Dimension table update- Allow updates of dimension tables without
   overwriting the entire partition (or table) using standard SQL syntax.</li>
   <li>Fact table inserts- Insert data into fact tables at granularity other
   than entire partitions using standard SQL syntax.</li>
   <li>Fact table update- Update large fact tables to correct data that
   was previously loaded.</li>
 </ul>
 It is important to support batch updates and maintain read consistency within
 a query. A non-goal is to support many simultaneous updates or to replace
 online transactions systems.
 <p>
 The design changes the layout of data within a partition from being in files
 at the top level to having base and delta directories. Each write operation in a table
 will be assigned a sequential table write id and each read operation
 will request the list of valid transactions/write ids.
 <ul>
   <li>Old format -
     <pre>
        $partition/$bucket
     </pre></li>
   <li>New format -
     <pre>
        $partition/base_$wid/$bucket
                   delta_$wid_$wid_$stid/$bucket
     </pre></li>
 </ul>
 <p>
 With each new write operation a new delta directory is created with events
 that correspond to inserted, updated, or deleted rows. Each of the files is
 stored sorted by the original write id (ascending), bucket (ascending),
 row id (ascending), and current write id (descending). Thus the files
 can be merged by advancing through the files in parallel.
 The stid is unique id (within the transaction) of the statement that created
 this delta file.
 <p>
 The base files include all transactions from the beginning of time
 (write id 0) to the write id in the directory name. Delta
 directories include transactions (inclusive) between the two write ids.
 <p>
 Because read operations get the list of valid transactions/write ids when they start,
 all reads are performed on that snapshot, regardless of any transactions that
 are committed afterwards.
 <p>
 The base and the delta directories have the write ids so that major
 (merge all deltas into the base) and minor (merge several deltas together)
 compactions can happen while readers continue their processing.
 <p>
 To support transitions between non-ACID layouts to ACID layouts, the input
 formats are expected to support both layouts and detect the correct one.
 <p>
   A note on the KEY of this InputFormat.  
   For row-at-a-time processing, KEY can conveniently pass RowId into the operator
   pipeline.  For vectorized execution the KEY could perhaps represent a range in the batch.
   Since <a href="../../../../../../org/apache/hadoop/hive/ql/io/orc/OrcInputFormat.html" title="class in org.apache.hadoop.hive.ql.io.orc"><code>OrcInputFormat</code></a> is declared to return
   <code>NullWritable</code> key, <a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.AcidRecordReader.html" title="interface in org.apache.hadoop.hive.ql.io"><code>AcidInputFormat.AcidRecordReader</code></a> is defined
   to provide access to the RowId.  Other implementations of AcidInputFormat can use either
   mechanism.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Interface and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.AcidRecordReader.html" title="interface in org.apache.hadoop.hive.ql.io">AcidInputFormat.AcidRecordReader</a>&lt;<a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.AcidRecordReader.html" title="type parameter in AcidInputFormat.AcidRecordReader">K</a>,<a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.AcidRecordReader.html" title="type parameter in AcidInputFormat.AcidRecordReader">V</a>&gt;</span></code>
<div class="block">RecordReader returned by AcidInputFormat working in row-at-a-time mode should AcidRecordReader.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.DeltaMetaData.html" title="class in org.apache.hadoop.hive.ql.io">AcidInputFormat.DeltaMetaData</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.Options.html" title="class in org.apache.hadoop.hive.ql.io">AcidInputFormat.Options</a></span></code>
<div class="block">Options for controlling the record readers.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.RawReader.html" title="interface in org.apache.hadoop.hive.ql.io">AcidInputFormat.RawReader</a>&lt;<a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.RawReader.html" title="type parameter in AcidInputFormat.RawReader">V</a>&gt;</span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.RowReader.html" title="interface in org.apache.hadoop.hive.ql.io">AcidInputFormat.RowReader</a>&lt;<a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.RowReader.html" title="type parameter in AcidInputFormat.RowReader">V</a>&gt;</span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.RawReader.html" title="interface in org.apache.hadoop.hive.ql.io">AcidInputFormat.RawReader</a>&lt;<a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.html" title="type parameter in AcidInputFormat">VALUE</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.html#getRawReader-org.apache.hadoop.conf.Configuration-boolean-int-org.apache.hadoop.hive.common.ValidWriteIdList-org.apache.hadoop.fs.Path-org.apache.hadoop.fs.Path:A-">getRawReader</a></span>(org.apache.hadoop.conf.Configuration&nbsp;conf,
            boolean&nbsp;collapseEvents,
            int&nbsp;bucket,
            org.apache.hadoop.hive.common.ValidWriteIdList&nbsp;validWriteIdList,
            org.apache.hadoop.fs.Path&nbsp;baseDirectory,
            org.apache.hadoop.fs.Path[]&nbsp;deltaDirectory)</code>
<div class="block">Get a reader that returns the raw ACID events (insert, update, delete).</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.RowReader.html" title="interface in org.apache.hadoop.hive.ql.io">AcidInputFormat.RowReader</a>&lt;<a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.html" title="type parameter in AcidInputFormat">VALUE</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.html#getReader-org.apache.hadoop.mapred.InputSplit-org.apache.hadoop.hive.ql.io.AcidInputFormat.Options-">getReader</a></span>(org.apache.hadoop.mapred.InputSplit&nbsp;split,
         <a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.Options.html" title="class in org.apache.hadoop.hive.ql.io">AcidInputFormat.Options</a>&nbsp;options)</code>
<div class="block">Get a record reader that provides the user-facing view of the data after
 it has been merged together.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.org.apache.hadoop.mapred.InputFormat">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.apache.hadoop.mapred.InputFormat</h3>
<code>getRecordReader, getSplits</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.org.apache.hadoop.hive.ql.io.InputFormatChecker">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.apache.hadoop.hive.ql.io.<a href="../../../../../../org/apache/hadoop/hive/ql/io/InputFormatChecker.html" title="interface in org.apache.hadoop.hive.ql.io">InputFormatChecker</a></h3>
<code><a href="../../../../../../org/apache/hadoop/hive/ql/io/InputFormatChecker.html#validateInput-org.apache.hadoop.fs.FileSystem-org.apache.hadoop.hive.conf.HiveConf-java.util.List-">validateInput</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getReader-org.apache.hadoop.mapred.InputSplit-org.apache.hadoop.hive.ql.io.AcidInputFormat.Options-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getReader</h4>
<pre><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.RowReader.html" title="interface in org.apache.hadoop.hive.ql.io">AcidInputFormat.RowReader</a>&lt;<a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.html" title="type parameter in AcidInputFormat">VALUE</a>&gt;&nbsp;getReader(org.apache.hadoop.mapred.InputSplit&nbsp;split,
                                           <a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.Options.html" title="class in org.apache.hadoop.hive.ql.io">AcidInputFormat.Options</a>&nbsp;options)
                                    throws <a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Get a record reader that provides the user-facing view of the data after
 it has been merged together. The key provides information about the
 record's identifier (write id, bucket, record id).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>split</code> - the split to read</dd>
<dd><code>options</code> - the options to read with</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a record reader</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="getRawReader-org.apache.hadoop.conf.Configuration-boolean-int-org.apache.hadoop.hive.common.ValidWriteIdList-org.apache.hadoop.fs.Path-org.apache.hadoop.fs.Path:A-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getRawReader</h4>
<pre><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.RawReader.html" title="interface in org.apache.hadoop.hive.ql.io">AcidInputFormat.RawReader</a>&lt;<a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.html" title="type parameter in AcidInputFormat">VALUE</a>&gt;&nbsp;getRawReader(org.apache.hadoop.conf.Configuration&nbsp;conf,
                                              boolean&nbsp;collapseEvents,
                                              int&nbsp;bucket,
                                              org.apache.hadoop.hive.common.ValidWriteIdList&nbsp;validWriteIdList,
                                              org.apache.hadoop.fs.Path&nbsp;baseDirectory,
                                              org.apache.hadoop.fs.Path[]&nbsp;deltaDirectory)
                                       throws <a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Get a reader that returns the raw ACID events (insert, update, delete).
 Should only be used by the compactor.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>conf</code> - the configuration</dd>
<dd><code>collapseEvents</code> - should the ACID events be collapsed so that only
                       the last version of the row is kept.</dd>
<dd><code>bucket</code> - the bucket to read</dd>
<dd><code>validWriteIdList</code> - the list of valid write ids to use</dd>
<dd><code>baseDirectory</code> - the base directory to read or the root directory for
                      old style files</dd>
<dd><code>deltaDirectory</code> - a list of delta files to include in the merge</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a record reader</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AcidInputFormat.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/hadoop/hive/ql/io/AbstractStorageFormatDescriptor.html" title="class in org.apache.hadoop.hive.ql.io"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/hadoop/hive/ql/io/AcidInputFormat.AcidRecordReader.html" title="interface in org.apache.hadoop.hive.ql.io"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/hadoop/hive/ql/io/AcidInputFormat.html" target="_top">Frames</a></li>
<li><a href="AcidInputFormat.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2019 <a href="https://www.apache.org/">The Apache Software Foundation</a>. All rights reserved.</small></p>
</body>
</html>
